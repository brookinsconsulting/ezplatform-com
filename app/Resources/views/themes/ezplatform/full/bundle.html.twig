{% extends '@ezdesign/pagelayout.html.twig' %}

{% block content %}
    <div class="bundle">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="bundle__banner bundle__banner--orange">
                        <h1 class="bundle__header">{{ bundle.packageId }}</h1>
                        <a href="{{ ez_field_value(content, 'packagist_url') }}" class="bundle__header-btn">Install Package</a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <ul class="bundle__nav-tab nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" href="#bundle-info" data-toggle="tab" role="tab" aria-controls="bundle-info" aria-selected="true">Bundle Info</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#comments" data-toggle="tab" role="tab" aria-controls="comments" aria-selected="false">Comments</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="//discuss.ezplatform.com/c/bundles" target="_blank">Support</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="row bundle__tab-content">
                <div class="col-md-8">
                    <div class="tab-content">
                        <div id="bundle-info" class="tab-pane fade show active" role="tabpanel" aria-labelledby="bundle-info">
                            {{ ez_render_field(content, 'description') }}
                        </div>
                        <div id="comments" class="tab-pane fade" role="tabpanel" aria-labelledby="comments">
                            {{ ez_comments_render_content(content.contentInfo, {
                                'identifier': content.id,
                                'url': app.request.uri
                            }) }}
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="bundle__details">
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Created by:</h2>
                            <div class="bundle__details-section-author">
                                {% set authorAvatar = bundle.authorAvatarUrl is defined ? bundle.authorAvatarUrl : bundle.maintainers[0].avatarUrl %}
                                {% set authorName = bundle.author.name is defined ? bundle.author.name : bundle.maintainers[0].name %}
                                <img src="{{ authorAvatar }}" class="author-avatar">
                                <p class="d-inline-block">{{ authorName }}</p>
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Categories:</h2>
                            <div class="bundle__details-section-categories">
                                {% if not ez_is_field_empty(content, 'bundle_category') %}
                                    {% for tags in content.fields.bundle_category %}
                                        {% for tag in tags.tags %}
                                            {% set tagKeyword = netgen_tags_tag_keyword( tag ) %}
                                            <a href="{{ path(ez_route('_ezplatform_bundles_list', { category: tagKeyword })) }}" class="bundle__category-btn bundle__category-btn--dark-grey">{{ tagKeyword }}</a>
                                        {% endfor %}
                                    {% endfor %}
                                {% endif %}
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Downloads:</h2>
                            <div class="bundle__details-section-downloads">
                                <i class="fa fa-download"></i>
                                {{ bundle.downloads }}
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Stars:</h2>
                            <div class="bundle__details-section-stars">
                                <i class="fa fa-star" aria-hidden="true"></i>
                                {{ bundle.stars }}
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Forks:</h2>
                            <div class="bundle__details-section-forks">
                                <i class="fa fa-code-fork" aria-hidden="true"></i>
                                {{ bundle.forks }}
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Created:</h2>
                            <div class="bundle__details-section-date">
                                {{ bundle.creationDate|date("Y-m-d") }}
                            </div>
                        </div>
                        <div class="bundle__details-section">
                            <h2 class="bundle__details-section-header">Updated:</h2>
                            <div class="bundle__details-section-date">
                                {{ bundle.updateDate|date("Y-m-d") }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
